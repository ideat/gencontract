<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "mindware.com.netbank.mappers.ClientLoanNetbankMapper">

    <resultMap type="clientloannetbank" id="ClientLoanNetbankResult">
        <id 	property="prmprcage" column="prmprcage"/>
        <result property="gbagendid" column="gbagendid"/>
        <result property="gbagenomb" column="gbagenomb"/>
        <result property="gbageeciv" column="gbageeciv"/>
        <result property="gbagesexo" column="gbagesexo"/>
        <result property="gbagedir" column="gbagedir"/>
        <result property="prmprnpre"  column="prmprnpre"/>
        <result property="prmprcmon" column="prmprcmon"/>
        <result property="prmprmdes" column="prmprmdes"/>
        <result property="prmprplzo" column="prmprplzo"/>
        <result property="prmprppgk" column="prmprppgk"/>
        <result property="prtsatbas" column="prtsatbas"/>
        <result property="prmprdiap" column="prmprdiap"/>

    </resultMap>


    <select id="findClientLoanNetbankByCreCod" resultMap="ClientLoanNetbankResult" parameterType="int">
        select prmprcage, gbagendid,gbagenomb, gbageeciv, gbagesexo,
        case
        	when gbagedir1 is null then ''
        	else gbagedir1
        end || ' ' ||
        case
          when  gbagedir2 is null then ''
          else gbagedir2
        end as gbagedir,
        prmprnpre, prmprcmon, prmprmdes, prmprplzo, prmprppgk, prmprdiap
        , case
            when prtsatbas is null then 0
            else prtsatbas
          end as prtsatbas
        from gbage
        inner join prmpr on (prmprcage = gbagecage)
        left join prtsa on (prmprnpre = prtsanpre)
        where prmprnpre = #{prmprnpre}

    </select>


</mapper>